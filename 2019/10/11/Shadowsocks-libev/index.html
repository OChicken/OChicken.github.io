<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"ochicken.top","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","width":240,"display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="本文是一篇配置Shadowsocks-libev的服务端和客户端的使用说明. 其中服务端可以多用户管理, 客户端则侧重于Ubuntu系统的代理. 关于如何配置VPS, 请参考上一篇博客, How to Build a Personal Blog. 当你有了一个VPS并搭了个个人博客, 顺手把Shadowsocks也搭了给国内的朋友们用是件很自然就想到的事情.">
<meta property="og:type" content="article">
<meta property="og:title" content="Shadowsocks-libev的Server和Client(for Linux)配置">
<meta property="og:url" content="https://ochicken.top/2019/10/11/Shadowsocks-libev/index.html">
<meta property="og:site_name" content="OChicken">
<meta property="og:description" content="本文是一篇配置Shadowsocks-libev的服务端和客户端的使用说明. 其中服务端可以多用户管理, 客户端则侧重于Ubuntu系统的代理. 关于如何配置VPS, 请参考上一篇博客, How to Build a Personal Blog. 当你有了一个VPS并搭了个个人博客, 顺手把Shadowsocks也搭了给国内的朋友们用是件很自然就想到的事情.">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-10-11T11:24:56.000Z">
<meta property="article:modified_time" content="2021-02-18T02:56:53.674Z">
<meta property="article:author" content="Shouran Ma">
<meta property="article:tag" content="Ubuntu 18">
<meta property="article:tag" content="Shadowsocks-libev">
<meta property="article:tag" content="VPS">
<meta property="article:tag" content="Server">
<meta property="article:tag" content="服务器">
<meta property="article:tag" content="Client">
<meta property="article:tag" content="客户端">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="多用户管理">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://ochicken.top/2019/10/11/Shadowsocks-libev/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Shadowsocks-libev的Server和Client(for Linux)配置 | OChicken</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">OChicken</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://ochicken.top/2019/10/11/Shadowsocks-libev/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/Cola.png">
      <meta itemprop="name" content="Shouran Ma">
      <meta itemprop="description" content="RWTH Physiker <br> 半职业码农">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="OChicken">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Shadowsocks-libev的Server和Client(for Linux)配置
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-10-11 13:24:56" itemprop="dateCreated datePublished" datetime="2019-10-11T13:24:56+02:00">2019-10-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-02-18 03:56:53" itemprop="dateModified" datetime="2021-02-18T03:56:53+01:00">2021-02-18</time>
              </span>

          
            <div class="post-description">本文是一篇配置Shadowsocks-libev的服务端和客户端的使用说明. 其中服务端可以多用户管理, 客户端则侧重于Ubuntu系统的代理. 关于如何配置VPS, 请参考上一篇博客, How to Build a Personal Blog. 当你有了一个VPS并搭了个个人博客, 顺手把Shadowsocks也搭了给国内的朋友们用是件很自然就想到的事情.</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <font size=2>

<h1 id="文献综述"><a href="#文献综述" class="headerlink" title="文献综述"></a>文献综述</h1><h2 id="VPN-VPS-Shadowsocks-ss-Shadowsocks-R-ssr"><a href="#VPN-VPS-Shadowsocks-ss-Shadowsocks-R-ssr" class="headerlink" title="VPN, VPS, Shadowsocks(ss), Shadowsocks-R(ssr)"></a>VPN, VPS, Shadowsocks(ss), Shadowsocks-R(ssr)</h2><p><a target="_blank" rel="noopener" href="https://medium.com/@thomas_summon/%E6%B5%85%E8%B0%88vpn-vps-proxy%E4%BB%A5%E5%8F%8Ashadowsocks%E4%B9%8B%E9%97%B4%E7%9A%84%E8%81%94%E7%B3%BB%E5%92%8C%E5%8C%BA%E5%88%AB-b0198f92db1b">浅谈vpn、vps、Proxy以及shadowsocks之间的联系和区别 - Thomas Xu - Medium</a><br><a target="_blank" rel="noopener" href="https://medium.com/@Blankwonder/%E5%90%84%E7%A7%8D%E5%8A%A0%E5%AF%86%E4%BB%A3%E7%90%86%E5%8D%8F%E8%AE%AE%E7%9A%84%E7%AE%80%E5%8D%95%E5%AF%B9%E6%AF%94-1ed52bf7a803">各种加密代理协议的简单对比 - Yachen Liu - Medium</a><br><a target="_blank" rel="noopener" href="https://deeponion.org/community/threads/vpnss-ssr.901/">Vpn与ss/ssr的区别 | DeepOnion Forum</a>  </p>
<h2 id="VPS推介"><a href="#VPS推介" class="headerlink" title="VPS推介"></a>VPS推介</h2><p><a target="_blank" rel="noopener" href="https://www.crifan.com/">在路上on the way - 走别人没走过的路，让别人有路可走</a><br><a target="_blank" rel="noopener" href="https://www.flyzy2005.com/">flyzy小站 - Learning on the way</a><br><a target="_blank" rel="noopener" href="https://flyzy2005.github.io/">flyzy小站 | flyzy小站，GitHub Pages分部</a><br><a target="_blank" rel="noopener" href="https://doubibackup.com/">逗比根据地 - 世界那么逗，我想出去看看</a>  </p>
<h2 id="Shadowsocks项目"><a href="#Shadowsocks项目" class="headerlink" title="Shadowsocks项目"></a>Shadowsocks项目</h2><p>时间最近的一篇教程: <a target="_blank" rel="noopener" href="https://crifan.github.io/scientific_network_summary/website/server_client_mode/ss_server/self_build_ss_server.html#">自己搭建服务器 · 科学上网相关知识总结</a><br>官网: <a target="_blank" rel="noopener" href="http://shadowsocks.org/en/index.html">Shadowsocks - A secure socks5 proxy</a><br>项目合集: <a target="_blank" rel="noopener" href="https://github.com/Shadowsocks">shadowsocks</a>, 有多个发行版, 用C/C++写就的有</p>
<ul>
<li><p>C写就的<a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-libev">shadowsocks/shadowsocks-libev: libev port of shadowsocks</a>;</p>
</li>
<li><p>C写就的<a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-qt5">shadowsocks/shadowsocks-qt5: A cross-platform shadowsocks GUI client</a>;</p>
</li>
<li><p>C++写就的<a target="_blank" rel="noopener" href="https://github.com/shadowsocks/libQtShadowsocks">shadowsocks/libQtShadowsocks: A lightweight and ultra-fast shadowsocks library written in C++14 with Qt framework</a>.</p>
</li>
</ul>
<p>(后两者共同指向同一个网站: <a target="_blank" rel="noopener" href="https://copr.fedorainfracloud.org/coprs/librehat/shadowsocks/">librehat/shadowsocks Copr</a>.) 2015年, clowwindy因喝茶事件被迫停止了shadowsocks的维护, 并删除了其开源在GitHub上的代码, Python版就此停滞. 但其它版本仍处于维护更新中. 其中, 更新最频繁, 新技术跟进最快的是由@madeye维护的shadowsocks-libev版本.</p>
<h1 id="Server"><a href="#Server" class="headerlink" title="Server"></a>Server</h1><h2 id="Install"><a href="#Install" class="headerlink" title="Install"></a>Install</h2><p>server &amp; client(for linux) 都要做的:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install shadowsocks-libev</span><br></pre></td></tr></table></figure>
<h2 id="Configuration-Files"><a href="#Configuration-Files" class="headerlink" title="Configuration Files"></a>Configuration Files</h2><p>各版本的默认配置文件如下</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/shadowsocks-python/config.json  <span class="comment">#Shadowsocks-Python</span></span><br><span class="line">vim /etc/shadowsocks-r/config.json       <span class="comment">#ShadowsocksR</span></span><br><span class="line">vim /etc/shadowsocks-go/config.json      <span class="comment">#Shadowsocks-Go</span></span><br><span class="line">vim /etc/shadowsocks-libev/config.json   <span class="comment">#Shadowsocks-libev</span></span><br></pre></td></tr></table></figure>
<p>内容无外乎</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;server&quot;</span>: <span class="string">&quot;134.209.239.83&quot;</span>,  <span class="comment">//[&quot;::1&quot;, &quot;127.0.0.1&quot;],</span></span><br><span class="line">    <span class="attr">&quot;server_port&quot;</span>: <span class="number">8388</span>,</span><br><span class="line">    <span class="comment">//&quot;local_address&quot;: &quot;127.0.0.1&quot;,</span></span><br><span class="line">    <span class="comment">//&quot;local_port&quot;: 1080,</span></span><br><span class="line">    <span class="attr">&quot;password&quot;</span>: <span class="string">&quot;1a2b3c4d5e6f7g&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;timeout&quot;</span>: <span class="number">60</span>,</span><br><span class="line">    <span class="attr">&quot;method&quot;</span>: <span class="string">&quot;chacha20-ietf-poly1305&quot;</span>,  <span class="comment">//以前常见的是aes-256-cfb</span></span><br><span class="line">    <span class="attr">&quot;mode&quot;</span>: <span class="string">&quot;tcp_and_udp&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Remarks:</strong> 端口的取值一般要&gt;1024, &lt;=65535=2^16-1. 这一说法来自于(<a target="_blank" rel="noopener" href="https://crifan.github.io/scientific_network_summary/website/server_client_mode/ss_server/self_build_ss_server.html#">自己搭建服务器 · 科学上网相关知识总结</a>), 像默认端口22肯定是不能被Shadowsocks登录的, 但必须保留22端口用于本地shell的ssh登录.</p>
<p>除了<code>/etc/shadowsocks-libev/config.json</code>, Shadowsocks-libev还有三个文件是很关键的:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/default/shadowsocks-libev</span><br><span class="line">CONFFILE=<span class="string">&quot;/etc/shadowsocks-libev/config.json&quot;</span>                  <span class="comment">#line15</span></span><br><span class="line"></span><br><span class="line">vim /lib/systemd/system/shadowsocks-libev.service</span><br><span class="line">EnvironmentFile=/etc/default/shadowsocks-libev                 <span class="comment">#line20</span></span><br><span class="line">ExecStart=/usr/bin/ss-server -c <span class="variable">$CONFFILE</span> <span class="variable">$DAEMON_ARGS</span>         <span class="comment">#line24</span></span><br><span class="line"></span><br><span class="line">vim /lib/systemd/system/<span class="string">&#x27;shadowsocks-libev-local@.service&#x27;</span></span><br><span class="line">ExecStart=/usr/bin/ss-local -c /etc/shadowsocks-libev/%i.json  <span class="comment">#line21</span></span><br></pre></td></tr></table></figure>
<p>最后一个跟本地客户端有关.</p>
<h2 id="开启服务-amp-Multi-User-Management"><a href="#开启服务-amp-Multi-User-Management" class="headerlink" title="开启服务 &amp; Multi-User Management"></a>开启服务 &amp; Multi-User Management</h2><p>Ref:<br><a target="_blank" rel="noopener" href="https://nonu.netlify.com/linux/ss-libev-multi-port/">Shadowsocks-libev 多端口配置方式 | Nonu’s Lab</a><br><a target="_blank" rel="noopener" href="https://blog.huihut.com/2016/12/03/BandwagonShadowsocksServer/">搬瓦工Shadowsocks安装及配置多用户(服务端) | HuiHut</a>(这里有用port_password这个格式来管理多用户, 然而, 亲测该配置不能用)  </p>
<p>博客上常见的有两种启动方式:</p>
<ol>
<li><code>ss-server /path/to/config.json</code>  </li>
<li><code>systemctl restart shadowsocks-libev</code></li>
</ol>
<p>初看, 方法2跟nginx的很像. 然而, 它只能管理一个config.json, 即只能管理一个用户. <code>$CONFFILE</code>是<code>/etc/default/shadowsocks-libev</code>line24里面的一个变量. 可以在这上面下功夫吗? 一次失败的尝试是给<code>/etc/default/shadowsocks-libev</code>加上CONFFILE1, CONFFILE2, …, 并在<code>/lib/systemd/system/shadowsocks-libev.service</code>第24行加上ExecStart … $CONFFILE1, … 执行<code>systemctl restart shadowsocks-libev</code>后没有报错, 但<code>/lib/systemd/system/shadowsocks-libev.service</code>的<code>ExecStart</code>只会读取最后一行的$CONFFILE, 前面的CONFFILE都跳过的. 这都说明<code>systemctl restart shadowsocks-libev</code>只能管理一个config.json. (或者对那几个关键文件适当修改是能够做到多用户启动的, 但这要 <strong>非常熟悉shell命令</strong> 才行.)</p>
<p>实际上, 开发团队早就造出了<code>shadowsocks-manager</code>. 不过这家伙似乎是图形化界面, 在服务端上并不好用(似乎服务器对应要装gnome-shell), 所以这里仅举出如何调用相关的包, 并不详解怎么做.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm i -g shadowsocks-manager</span><br><span class="line">ss-manager -c /etc/shadowsocks-libev/config.json</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://github.com/shadowsocks/shadowsocks-manager">shadowsocks/shadowsocks-manager: A shadowsocks manager tool for multi user and traffic control.</a><br><a target="_blank" rel="noopener" href="https://shadowsocks.github.io/shadowsocks-manager/#/">Shadowsocks-Manager</a>  </p>
<p>总之, 在我的服务器配置里我采用如下管理方案:</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>被管理的文件</th>
<th>Port</th>
<th>用途</th>
</tr>
</thead>
<tbody><tr>
<td>systemctl restart shadowsocks-libev</td>
<td>config.json</td>
<td>8388</td>
<td>自用自测</td>
</tr>
<tr>
<td>./shadowsocks-libev-run.sh</td>
<td>config_1.json, config_2.json, …</td>
<td>1024-65536</td>
<td>多用户管理, 积德</td>
</tr>
</tbody></table>
<p><code>shadowsocks-libev-run.sh</code>的写法为</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ss-server -c /etc/shadowsocks-libev/config_1.json &amp;</span><br><span class="line">ss-server -c /etc/shadowsocks-libev/config_2.json &amp;</span><br></pre></td></tr></table></figure>
<p>别忘了<code>chmod 755 shadowsocks-libev-run.sh</code>.</p>
<p>执行如下命令就能够打开并监控所有shadowsocks-libev的配置了</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart shadowsocks-libev               <span class="comment">#启动config.json</span></span><br><span class="line">systemctl <span class="built_in">enable</span> shadowsocks-libev                <span class="comment">#开机启动</span></span><br><span class="line">systemctl status shadowsocks-libev                <span class="comment">#查看状态</span></span><br><span class="line">/etc/shadowsocks-libev/shadowsocks-libev-run.sh   <span class="comment">#一键启动config_1.json, config_2.json, ...</span></span><br><span class="line">netstat -anptuo | grep 8388                       <span class="comment">#p: 显示PID进程号; tu: 指明显示TCP端口和UDP端口. anp参数必须有</span></span><br><span class="line">lsof -i:8388                                      <span class="comment">#功能同上</span></span><br><span class="line">netstat -anptuo | grep ss-server</span><br><span class="line">ps -ef | grep ss-server</span><br></pre></td></tr></table></figure>
<p>最后一条是检测网络端口的监听状况. You can see that ports 8388, 1234, 5678 are listened. However, 他们还暂时不能连上: 因为服务器的防火墙还没开通对应端口.<br>虽然写shell script的方法看上去有点笨, 如果服务器重启, 得自己再执行一遍; 但由于服务器不出意外从不关机, 这种笨方法是能用的.</p>
<p><strong>Remarks:</strong> 如果启动时报出一个很物理的错:  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">This system doesn&#39;t provide enough entropy to quickly generate high-quality random numbers</span><br></pre></td></tr></table></figure>
<p>原因也正如提示中所说, 系统没有足够的熵, 这时候可以通过安装rng-tools来解决这个问题. 如果不安装rng-tools, 等待一定的时间后, 服务也可以正常运行, 至于用还是不用, 请自行取舍.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get install rng-tools</span><br><span class="line">vim /etc/default/rng-tools</span><br><span class="line">HRNGDEVICE=/dev/urandom</span><br></pre></td></tr></table></figure>
<p>Refs: <a target="_blank" rel="noopener" href="https://blog.javaltx.com/Shadowsocks/16.html">安装rng-tools使Shadowsocks-libev有足够的熵可用 - 刘洋同学的博客</a>  </p>
<h2 id="最后一步-GFW-开通端口"><a href="#最后一步-GFW-开通端口" class="headerlink" title="最后一步: GFW 开通端口"></a>最后一步: GFW 开通端口</h2><p><strong>Note:</strong> 在这之前我做了<code>ufw enable</code>和<code>ufw default deny</code>.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ufw allow 8388            <span class="comment">#Shadowsocks自用端口</span></span><br><span class="line">ufw delete allow 8388     <span class="comment">#删除Shadowsocks端口</span></span><br><span class="line">ufw status                <span class="comment">#查看服务器防火墙状态</span></span><br></pre></td></tr></table></figure>
<p>可以看到输出中应该包含端口8388. </p>
<h2 id="性能优化-Optional"><a href="#性能优化-Optional" class="headerlink" title="性能优化(Optional)"></a>性能优化(Optional)</h2><p>Ref: <a target="_blank" rel="noopener" href="https://blog.huihut.com/2016/12/03/BandwagonShadowsocksServer/">搬瓦工Shadowsocks安装及配置多用户(服务端) | HuiHut</a><br>编辑<code>vim /etc/sysctl.d/local.conf</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"># max open files</span><br><span class="line">fs.file-max &#x3D; 1024000</span><br><span class="line"># max read buffer</span><br><span class="line">net.core.rmem_max &#x3D; 67108864</span><br><span class="line"># max write buffer</span><br><span class="line">net.core.wmem_max &#x3D; 67108864</span><br><span class="line"># default read buffer</span><br><span class="line">net.core.rmem_default &#x3D; 65536</span><br><span class="line"># default write buffer</span><br><span class="line">net.core.wmem_default &#x3D; 65536</span><br><span class="line"># max processor input queue</span><br><span class="line">net.core.netdev_max_backlog &#x3D; 4096</span><br><span class="line"># max backlog</span><br><span class="line">net.core.somaxconn &#x3D; 4096</span><br><span class="line"></span><br><span class="line"># resist SYN flood attacks</span><br><span class="line">net.ipv4.tcp_syncookies &#x3D; 1</span><br><span class="line"># reuse timewait sockets when safe</span><br><span class="line">net.ipv4.tcp_tw_reuse &#x3D; 1</span><br><span class="line"># turn off fast timewait sockets recycling</span><br><span class="line">net.ipv4.tcp_tw_recycle &#x3D; 0</span><br><span class="line"># short FIN timeout</span><br><span class="line">net.ipv4.tcp_fin_timeout &#x3D; 30</span><br><span class="line"># short keepalive time</span><br><span class="line">net.ipv4.tcp_keepalive_time &#x3D; 1200</span><br><span class="line"># outbound port range</span><br><span class="line">net.ipv4.ip_local_port_range &#x3D; 10000 65000</span><br><span class="line"># max SYN backlog</span><br><span class="line">net.ipv4.tcp_max_syn_backlog &#x3D; 4096</span><br><span class="line"># max timewait sockets held by system simultaneously</span><br><span class="line">net.ipv4.tcp_max_tw_buckets &#x3D; 5000</span><br><span class="line"># TCP receive buffer</span><br><span class="line">net.ipv4.tcp_rmem &#x3D; 4096 87380 67108864</span><br><span class="line"># TCP write buffer</span><br><span class="line">net.ipv4.tcp_wmem &#x3D; 4096 65536 67108864</span><br><span class="line"># turn on path MTU discovery</span><br><span class="line">net.ipv4.tcp_mtu_probing &#x3D; 1</span><br><span class="line"></span><br><span class="line"># for high-latency network</span><br><span class="line">net.ipv4.tcp_congestion_control &#x3D; hybla</span><br><span class="line"># forward ivp4</span><br><span class="line">net.ipv4.ip_forward &#x3D; 1</span><br></pre></td></tr></table></figure>
<p>使配置生效: <code>sysctl --system</code></p>
<h2 id="Server-HyperRef"><a href="#Server-HyperRef" class="headerlink" title="Server-HyperRef"></a>Server-HyperRef</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/shadowsocks-libev/config.json</span><br><span class="line">systemctl restart shadowsocks-libev               <span class="comment">#启动config.json</span></span><br><span class="line">systemctl status shadowsocks-libev                <span class="comment">#查看状态</span></span><br><span class="line">/etc/shadowsocks-libev/shadowsocks-libev-run.sh   <span class="comment">#一键启动config_1.json, config_2.json, ...</span></span><br><span class="line">ufw allow 8388                                    <span class="comment">#增加端口</span></span><br><span class="line">ufw delete allow 8388                             <span class="comment">#删除端口</span></span><br><span class="line">ufw status                                        <span class="comment">#查看服务器防火墙状态</span></span><br><span class="line">netstat -anptuo | grep 8388                       <span class="comment">#p: 显示PID进程号; tu: 指明显示TCP端口和UDP端口. anp参数必须有</span></span><br><span class="line">netstat -anptuo | grep ss-server</span><br></pre></td></tr></table></figure>
<h1 id="Client-Linux"><a href="#Client-Linux" class="headerlink" title="Client (Linux)"></a>Client (Linux)</h1><h2 id="Configure-and-Start"><a href="#Configure-and-Start" class="headerlink" title="Configure and Start"></a>Configure and Start</h2><p>按照老方法安装好shadowsocks-libev之后</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/shadowsocks-libev/config.json</span><br></pre></td></tr></table></figure>
<p>作如下修改:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;server&quot;</span>: <span class="string">&quot;134.209.239.83&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;server_port&quot;</span>: <span class="number">8388</span>,</span><br><span class="line">    <span class="attr">&quot;local_address&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;local_port&quot;</span>: <span class="number">1080</span></span><br><span class="line">    <span class="string">&quot;password&quot;</span>: <span class="string">&quot;1a2b3c4d5e6f7g&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;timeout&quot;</span>: <span class="number">60</span>,</span><br><span class="line">    <span class="attr">&quot;method&quot;</span>: <span class="string">&quot;chacha20-ietf-poly1305&quot;</span>,  <span class="comment">//以前常见的是aes-256-cfb</span></span><br><span class="line">    <span class="attr">&quot;mode&quot;</span>: <span class="string">&quot;tcp_and_udp&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后重启并监测状态</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart shadowsocks-libev-local@config  <span class="comment">#本地启动Shadowsocks</span></span><br><span class="line">sudo service shadowsocks-libev-local@config restart    <span class="comment">#功能同上</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> shadowsocks-libev-local@config   <span class="comment">#配置开机自启</span></span><br><span class="line">sudo systemctl status shadowsocks-libev-local@config   <span class="comment">#查看状态</span></span><br><span class="line">sudo netstat -anptuo | grep 8388                       <span class="comment">#p: 显示PID进程号; tu: 指明显示TCP端口和UDP端口. anp参数必须有</span></span><br><span class="line">lsof -i:8388                                           <span class="comment">#功能同上</span></span><br><span class="line">sudo netstat -anp | grep ss-local</span><br><span class="line">sudo ps -ef | grep ss-server</span><br></pre></td></tr></table></figure>
<p><strong>Remarks:</strong> 以下三条命令等价:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start shadowsocks-libev-local@config</span><br><span class="line">sudo ss-local -c /etc/shadowsocks-libev/config.json &amp;</span><br><span class="line">sudo ss-local -s 134.209.239.83 -p 8388 -l 1080 -ki 1a2b3c4d5e6f7g -m chacha20-ietf-poly1305 &amp;</span><br></pre></td></tr></table></figure>
<p>参见<code>/lib/systemd/system/&#39;shadowsocks-libev-local@.service&#39;</code>第21行.</p>
<h2 id="代理"><a href="#代理" class="headerlink" title="代理"></a>代理</h2><p>配置好前面的东西之后还并不能帆樯, 因为Linux依旧默认走http和https流量. 要把这些流量用Socks5代理, 才可以实现帆樯.</p>
<h3 id="使用系统图形界面无脑全局设置"><a href="#使用系统图形界面无脑全局设置" class="headerlink" title="使用系统图形界面无脑全局设置"></a>使用系统图形界面无脑全局设置</h3><p><a target="_blank" rel="noopener" href="https://zazalu.space/2019/06/06/ubuntu18-04%E9%85%8D%E7%BD%AEshadowsocks%E5%AE%A2%E6%88%B7%E7%AB%AF/">ubuntu18.04配置shadowsocks客户端</a><br><a target="_blank" rel="noopener" href="https://blog.huihut.com/2017/08/25/LinuxInstallConfigShadowsocksClient/">Linux安装配置Shadowsocks客户端及开机自动启动 | HuiHut</a><br>打开ubuntu系统的设置 -&gt; Network -&gt; Network Proxy -&gt; Manual -&gt; 在socks Host 一栏输入 <code>127.0.0.1</code>, 端口<code>1080</code>即可. <strong>浏览器</strong> 输入<code>ifconfig.me</code>可以查看自己是否在墙外.<br>这个只对图形界面有效, 不过能够驾驭绝大部分使用场景了, 譬如Telegram和WhatsApp.</p>
<h3 id="使用polipo实现在terminal的全局代理"><a href="#使用polipo实现在terminal的全局代理" class="headerlink" title="使用polipo实现在terminal的全局代理"></a>使用<code>polipo</code>实现在terminal的全局代理</h3><p><a target="_blank" rel="noopener" href="https://fqk.io/linux-shadowsocks-global/">Linux 下 shadowsocks 客户端全局代理 | Fang</a><br><a target="_blank" rel="noopener" href="https://jingsam.github.io/2016/05/08/setup-shadowsocks-http-proxy-on-ubuntu-server.html">Ubuntu server命令行配置shadowsocks全局代理 - jingsam</a>  </p>
<ol>
<li>安装并启动<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install polipo</span><br><span class="line">sudo systemctl start polipo</span><br></pre></td></tr></table></figure></li>
<li>编辑配置文件: <code>sudo vim /etc/polipo/config</code><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This file only needs to list configuration variables that deviate</span></span><br><span class="line"><span class="comment"># from the default values.  See /usr/share/doc/polipo/examples/config.sample</span></span><br><span class="line"><span class="comment"># and &quot;polipo -v&quot; for variables you can tweak and further information.</span></span><br><span class="line"></span><br><span class="line">logSyslog = <span class="literal">true</span></span><br><span class="line">logFile = /var/<span class="built_in">log</span>/polipo/polipo.log</span><br><span class="line"></span><br><span class="line">proxyAddress = <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line"></span><br><span class="line">socksParentProxy = <span class="string">&quot;127.0.0.1:1080&quot;</span></span><br><span class="line">socksProxyType = socks5</span><br><span class="line"></span><br><span class="line">chunkHighMark = 50331648</span><br><span class="line">objectHighMark = 16384</span><br><span class="line"></span><br><span class="line">serverMaxSlots = 64</span><br><span class="line">serverSlots = 16</span><br><span class="line">serverSlots1 = 32</span><br></pre></td></tr></table></figure></li>
<li>重启服务<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart polipo</span><br><span class="line">sudo systemctl status polipo</span><br></pre></td></tr></table></figure></li>
<li>设置环境变量<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> http_proxy=<span class="string">&quot;http://127.0.0.1:8123/&quot;</span></span><br><span class="line"><span class="built_in">export</span> https_proxy=<span class="string">&quot;http://127.0.0.1:8123/&quot;</span></span><br></pre></td></tr></table></figure>
测试一下此时的IP<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl ifconfig.me</span><br></pre></td></tr></table></figure>
若是VPS的IP, 说明帆樯成功. 以上最关键的一步是设置环境变量, 使得http和https的流量都用socks5代理.</li>
</ol>
<p>不过polipo仅仅是在当前terminal下成立, 在别的terminal要再设置一回环境变量. 这看起来有点弱智因为并没有做到每个terminal都默认代理又不能用到Chrome浏览器; 不过也有两个好处:</p>
<ol>
<li>服务器配置其实往往并没有自己的电脑强, 什么都拿去挂服务器运行后果可想而知.  </li>
<li>Terminal无非是用来装packages, 虽然说绝大部分包的寄托站点在墙内都能访问但下载速度奇慢, 所以不妨使用代理来下载.  </li>
</ol>
<p><strong>Remarks:</strong> <a target="_blank" rel="noopener" href="http://www.runoob.com/linux/linux-comm-export.html">Linux export命令 | 菜鸟教程</a>, 有讲如何查看和删除环境变量: </p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> -p</span><br><span class="line"><span class="built_in">export</span> -n http_proxy</span><br><span class="line"><span class="built_in">export</span> -n https_proxy</span><br></pre></td></tr></table></figure>
<h3 id="使用genpac智能代理"><a href="#使用genpac智能代理" class="headerlink" title="使用genpac智能代理"></a>使用<code>genpac</code>智能代理</h3><p>Ref:<br><a target="_blank" rel="noopener" href="https://idealclover.top/archives/339/">ubuntu 16.04 下 shadowsocks 配置，安装与自动启动 - idealclover</a><br><a target="_blank" rel="noopener" href="https://claude-ray.github.io/2018/12/01/ss-local/">Ubuntu配置ss-local客户端 | Claude’s Blog</a><br>安装genpac并在/home/ochicken/目录下生成autoproxy.pac</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pip install genpac</span><br><span class="line">genpac --pac-proxy <span class="string">&quot;SOCKS5 127.0.0.1:1080&quot;</span> --gfwlist-proxy=<span class="string">&quot;SOCKS5 127.0.0.1:1080&quot;</span> --output=<span class="string">&quot;~/autoproxy.pac&quot;</span></span><br></pre></td></tr></table></figure>
<p>打开ubuntu的<code>settings - Network - Network proxy</code>, 选择方法为自动 (Automatic), URL为<code>file:///&#123;pac文件路径&#125;</code>, 如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:&#x2F;&#x2F;&#x2F;home&#x2F;ochicken&#x2F;autoproxy.pac</span><br></pre></td></tr></table></figure>
<p>不过由于该智能代理列表都是被GFW封禁的网页, 现在我自己在墙外, 没法亲测.</p>
<h3 id="使用proxychains"><a href="#使用proxychains" class="headerlink" title="使用proxychains"></a>使用<code>proxychains</code></h3><p>Ref: <a target="_blank" rel="noopener" href="https://www.yooomu.com/archives/107.html">在Linux上使用ss客户端并设置代理 - Kong’s Blog</a><br>这个方案不好的地方在于, terminal执行命令前都要加个<code>proxychains</code>.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install proxychains</span><br><span class="line">sudo vim /etc/proxychains.conf</span><br><span class="line">socks5 127.0.0.1 1080             //修改最后一行</span><br></pre></td></tr></table></figure>
<p>然后就可以用<code>proxychains+commands</code>的方式来代理. 例如</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">proxychains curl xxxx</span><br><span class="line">proxychains wget xxxx</span><br><span class="line">sudo proxychains apt-get xxxx</span><br></pre></td></tr></table></figure>
<h3 id="使用privoxy"><a href="#使用privoxy" class="headerlink" title="使用privoxy"></a>使用<code>privoxy</code></h3><p>Refs:<br><a target="_blank" rel="noopener" href="https://xingjian.space/Computer-Network/global-proxy-of-Shadowsocks-in-Ubuntu/">Ubuntu配置Shadowsocks全局代理 | 悬崖边上的日与夜</a><br><a target="_blank" rel="noopener" href="https://blog.liuguofeng.com/p/4010">Linux 安装 Shadowsocks 客户端 并全局代理 – LIUGUOFENG</a><br>Privoxy的功能据第一篇Blog来看, 跟polipo是很相近的. 但感觉这个的配置更麻烦, 就放弃了.</p>
<h2 id="Client-HyperRef"><a href="#Client-HyperRef" class="headerlink" title="Client-HyperRef"></a>Client-HyperRef</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/shadowsocks-libev/config.json</span><br><span class="line">sudo systemctl restart shadowsocks-libev-local@config  <span class="comment">#本地启动Shadowsocks</span></span><br><span class="line">sudo systemctl status shadowsocks-libev-local@config   <span class="comment">#查看状态</span></span><br><span class="line">sudo netstat -anptuo | grep 8388                       <span class="comment">#p: 显示PID进程号; tu: 指明显示TCP端口和UDP端口. anp参数必须有</span></span><br><span class="line">sudo netstat -anp | grep ss-local</span><br><span class="line">curl ifconfig.me                                       <span class="comment">#查看自己公网IP. 正确答案是VPS的IP</span></span><br><span class="line"><span class="built_in">export</span> http_proxy=<span class="string">&quot;http://127.0.0.1:8123/&quot;</span></span><br><span class="line"><span class="built_in">export</span> https_proxy=<span class="string">&quot;http://127.0.0.1:8123/&quot;</span></span><br><span class="line"><span class="built_in">export</span> -p</span><br><span class="line"><span class="built_in">export</span> -n http_proxy</span><br><span class="line"><span class="built_in">export</span> -n https_proxy</span><br></pre></td></tr></table></figure>
<h1 id="开通名单"><a href="#开通名单" class="headerlink" title="开通名单"></a>开通名单</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ss-local -s 134.209.239.83 -p 1234 -l 1080 -ki abcdefg -m chacha20-ietf-poly1305  <span class="comment">#config_1.json User1</span></span><br><span class="line">ss-local -s 134.209.239.83 -p 4321 -l 1080 -ki gfedcba -m chacha20-ietf-poly1305  <span class="comment">#config_2.json User2</span></span><br><span class="line">ss-local -s 134.209.239.83 -p 5678 -l 1080 -ki hijklmn -m chacha20-ietf-poly1305  <span class="comment">#config_3.json User3</span></span><br><span class="line">ss-local -s 134.209.239.83 -p 8765 -l 1080 -ki nmlkjih -m chacha20-ietf-poly1305  <span class="comment">#config_4.json User4</span></span><br></pre></td></tr></table></figure>
</font>

    </div>

    
    
    
        

  <div class="followme">
    <p>Welcome to my other publishing channels</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/images/wechat_channel.jpg">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Ubuntu-18/" rel="tag"># Ubuntu 18</a>
              <a href="/tags/Shadowsocks-libev/" rel="tag"># Shadowsocks-libev</a>
              <a href="/tags/VPS/" rel="tag"># VPS</a>
              <a href="/tags/Server/" rel="tag"># Server</a>
              <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/" rel="tag"># 服务器</a>
              <a href="/tags/Client/" rel="tag"># Client</a>
              <a href="/tags/%E5%AE%A2%E6%88%B7%E7%AB%AF/" rel="tag"># 客户端</a>
              <a href="/tags/Linux/" rel="tag"># Linux</a>
              <a href="/tags/%E5%A4%9A%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/" rel="tag"># 多用户管理</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/09/30/How-to-Build-a-Personal-Blog/" rel="prev" title="How to Build a Personal Blog">
      <i class="fa fa-chevron-left"></i> How to Build a Personal Blog
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/02/18/Test/" rel="next" title="Test">
      Test <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E7%8C%AE%E7%BB%BC%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">文献综述</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#VPN-VPS-Shadowsocks-ss-Shadowsocks-R-ssr"><span class="nav-number">1.1.</span> <span class="nav-text">VPN, VPS, Shadowsocks(ss), Shadowsocks-R(ssr)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#VPS%E6%8E%A8%E4%BB%8B"><span class="nav-number">1.2.</span> <span class="nav-text">VPS推介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Shadowsocks%E9%A1%B9%E7%9B%AE"><span class="nav-number">1.3.</span> <span class="nav-text">Shadowsocks项目</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Server"><span class="nav-number">2.</span> <span class="nav-text">Server</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Install"><span class="nav-number">2.1.</span> <span class="nav-text">Install</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Configuration-Files"><span class="nav-number">2.2.</span> <span class="nav-text">Configuration Files</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E5%90%AF%E6%9C%8D%E5%8A%A1-amp-Multi-User-Management"><span class="nav-number">2.3.</span> <span class="nav-text">开启服务 &amp; Multi-User Management</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%80%E5%90%8E%E4%B8%80%E6%AD%A5-GFW-%E5%BC%80%E9%80%9A%E7%AB%AF%E5%8F%A3"><span class="nav-number">2.4.</span> <span class="nav-text">最后一步: GFW 开通端口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-Optional"><span class="nav-number">2.5.</span> <span class="nav-text">性能优化(Optional)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Server-HyperRef"><span class="nav-number">2.6.</span> <span class="nav-text">Server-HyperRef</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Client-Linux"><span class="nav-number">3.</span> <span class="nav-text">Client (Linux)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Configure-and-Start"><span class="nav-number">3.1.</span> <span class="nav-text">Configure and Start</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%90%86"><span class="nav-number">3.2.</span> <span class="nav-text">代理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E7%B3%BB%E7%BB%9F%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2%E6%97%A0%E8%84%91%E5%85%A8%E5%B1%80%E8%AE%BE%E7%BD%AE"><span class="nav-number">3.2.1.</span> <span class="nav-text">使用系统图形界面无脑全局设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8polipo%E5%AE%9E%E7%8E%B0%E5%9C%A8terminal%E7%9A%84%E5%85%A8%E5%B1%80%E4%BB%A3%E7%90%86"><span class="nav-number">3.2.2.</span> <span class="nav-text">使用polipo实现在terminal的全局代理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8genpac%E6%99%BA%E8%83%BD%E4%BB%A3%E7%90%86"><span class="nav-number">3.2.3.</span> <span class="nav-text">使用genpac智能代理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8proxychains"><span class="nav-number">3.2.4.</span> <span class="nav-text">使用proxychains</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8privoxy"><span class="nav-number">3.2.5.</span> <span class="nav-text">使用privoxy</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Client-HyperRef"><span class="nav-number">3.3.</span> <span class="nav-text">Client-HyperRef</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%BC%80%E9%80%9A%E5%90%8D%E5%8D%95"><span class="nav-number">4.</span> <span class="nav-text">开通名单</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Shouran Ma"
      src="/images/Cola.png">
  <p class="site-author-name" itemprop="name">Shouran Ma</p>
  <div class="site-description" itemprop="description">RWTH Physiker <br> 半职业码农</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">7</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/OChicken" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;OChicken" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:shouran.ma@rwth-aachen.de" title="E-Mail → mailto:shouran.ma@rwth-aachen.de" rel="noopener" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Shouran Ma</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
